# JavaScript のデータ型

下記の JavaScript コードの出力は何になるでしょうか？

``` javascript
const person = {name: 'John'};
const newPerson = person;

newPerson.name = 'David';
console.log(person.name); // １の出力
console.log(newPerson.name); // ２の出力
```

１の出力が'John'で、２の出力が'David' になると思った方、注意が必要です。

正解は、'David'が2回出力されることになります。

▼正解(出力される文字列)
```
David
David
```

ここでのポイントは、JavaScript ではデータの型として「基本型」と「参照型」を持つ ということです。
つまり、基本型は値そのものを直接扱い、参照型はオブジェクトの参照を扱うため、同じオブジェクトを指す複数の変数が存在する場合、どの変数からもオブジェクトの変更が反映されてしまうのです。

内容を詳しく説明します。

## 「基本型」とは
基本型として扱われるデータ型には、次のような種類があります。

**▼基本型のデータ型の例**
| DataType  | 説明                               |
| --------- | ---------------------------------- |
| Number    | 数値を表します                     |
| String    | 文字列を表します                   |
| Boolean   | true / false を表します            |
| null      | 値が存在しないことを表します       |
| undefined | 値が定義されていないことを表します |
| Symbol    | 一意な識別子を表します             |
| BigInt    | 非常に大きい整数を扱えます         |

基本型は変数に値自体が保存されるため、一度コピーされた値を変更しても元の変数には影響しません。
また、メモリ的にもそれぞれが独立した領域に値を保持するイメージです。

```javascript
let a = 10;
let b = a; // aをbに代入
b = 20;
console.log(a); // 10（bの値を更新しても、aには影響しない）
console.log(b); // 20
```

上記のコード例のように、変数を他の変数に代入することは、代入元の変数に格納された値そのものを、代入先の変数にコピーするような動きとなります。
この動きを、「値渡し」と言います。

## 「参照型」とは
参照型として扱われるデータ型には、次のような種類があります。

**▼参照型のデータ型の例**
| DataType | 説明                                             |
| -------- | ------------------------------------------------ |
| Object   | プレーンオブジェクトやDate、RegExpなどを含みます |
| Array    | 配列もオブジェクトの一種です                     |
| Function | 関数もオブジェクト扱いです                       |

参照型の変数には、オブジェクトそのものではなく、そのオブジェクトを指す参照を格納します。
複数の変数が同じ参照を共有している場合、オブジェクトを変更すると他の変数から見たときも変更が反映されます。

```javascript
const obj1 = {name: 'Alice'};
const obj2 = obj1; // obj1で定義されたオブジェクトへの参照をobj2へ渡す（ポインタを渡すイメージ）
obj2.name = 'Bob'; // obj2の参照先とobj1の参照先は同じオブジェクトのため、どちらも更新することになる
console.log(obj1.name); // Bob
console.log(obj2.name); // Bob
```

上記コード例のように、変数の値のみを渡すのではなく、オブジェクトの参照を渡す動きを、「参照渡し」と言います。

では、オブジェクトの参照を渡すのではなく、コピーして別々のオブジェクトとして扱いたい場合、どのようにすれば良いでしょうか？

## 参照型のコピーを実装する方法
配列やオブジェクトの値をコピーする方法はいくつか存在します。
ここでは、代表的な手法を紹介します。

### 配列のコピー

#### スプレッド構文を使用する
スプレッド構文 (...) を使うと、配列の要素を展開して新しい配列を作ることができます。

```javascript
const array1 = [1, 2, 3];
const array2 = [...array1]; // [1, 2, 3]になるイメージ
array2.push(4);
console.log(array1); // [1, 2, 3]
console.log(array2); // [1, 2, 3, 4]
```

#### Array.from() を使用する
Array.from() を使うと、元の配列をまるごとコピーした新しい配列を作ることができます。

```javascript
const array1 = [1, 2, 3];
const array2 = Array.from(array1);
array2.push(4);
console.log(array1); // [1, 2, 3]
console.log(array2); // [1, 2, 3, 4]
```

### オブジェクトのコピー

#### スプレット構文
スプレッド構文 (...) は、既存のオブジェクトのプロパティを展開してコピーしたり、新たにプロパティを追加・上書きするのに便利です。
元のオブジェクトに影響を与えずに操作できます。

```javascript
const obj1 = {a: 1, b: 2};
const obj2 = {...obj1};
obj2.b = 3;
console.log(obj1); // {a: 1, b: 2}
console.log(obj2); // {a: 1, b: 3}
```

#### Object.assign() を使用する
Object.assign() メソッドを使用すると、元のオブジェクトをコピーして新しいオブジェクトを作成できます。

```javascript
const obj1 = {a: 1, b: 2};
const obj2 = Object.assign({}, obj1);
obj2.b = 3;
console.log(obj1); // {a: 1, b: 2}
console.log(obj2); // {a: 1, b: 3}
```

ES2015で追加されたスプレット構文を覚えておくと、配列・オブジェクトのどちらのコピーの実装にも対応できます。
